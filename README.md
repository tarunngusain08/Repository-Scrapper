# Repository Scrapper

This repository contains a Go program and a small API designed to scrape GitHub repositories, specifically Go projects, to generate dependency trees. The program and API consider all the dependencies in the repository while creating the output and restrict dependency generation to only Go projects.

## Features

- Scrapes GitHub repositories to generate dependency trees.
- Supports only Go projects for dependency tree generation.
- Outputs the dependency tree in JSON format.
- Caches the dependency tree on disk as a JSON file for future reference.
- Provides a small API to retrieve dependency trees of Go projects.

## API Endpoint

The API provides the following endpoint:

### `/get-dependency-tree`

- **Method:** POST
- **Request Body:**
  - GitHub repository URL
  - Branch or tag
- **Response:**
  - Dependency tree of the project

## Artifact Struct

The program and API retain information about each package, including the root, in the following struct:

```go
type Artifact struct {
  Name          string
  Version       string
  Dependencies  []*Artifact
}
```

## Example

Suppose we have an imaginary Go project called "A" with the following dependencies:

```
A
|_B
|  |_D
|_C
```

The `output.json` file generated by the program would look like this:

```json
[
    {
        "name": "A",
        "version": "1.0",
        "dependencies": [
            {
                "name": "B",
                "version": "1.0",
                "dependencies": [
                    {
                        "name": "D",
                        "version": "1.0",
                        "dependencies": []
                    }
                ]
            },
            {
                "name": "C",
                "version": "1.0",
                "dependencies": []
            }
        ]
    }
]
```

## Solution Overview

### Components

- **DependencyTree**: The main struct representing the dependency tree and its associated methods.
- **Artifact**: A struct representing a software artifact with its name, version, and dependencies.
- **GitHubContent**: A struct representing the content fetched from GitHub.
- **GetBody**: A struct representing the body of the HTTP request.
- **GoMod**: A struct representing the content of the `go.mod` file.
- **DependencyTreeFetcher**: An interface defining the `Get` method.
- **NewDependencyTree**: A constructor function to create a new `DependencyTree`.
- **Get**: A method to handle the HTTP GET request.
- **isValidURL**: A method to validate the URL.
- **getDependencyTree**: A method to initiate the process of fetching and parsing the dependency tree.
- **fetchGoMod**: A method to fetch the content of the `go.mod` file from a given repository URL.
- **fetch**: A method to handle the fetching process concurrently using goroutines and channels.
- **parseGoMod**: A method to parse the content of the `go.mod` file and build the dependency tree.
- **parse**: A method to handle the parsing process concurrently using goroutines and channels.
- **errorHandler**: A method to handle errors encountered during the fetching and parsing process.

### Initialization

- The `NewDependencyTree` function initializes a new `DependencyTree` instance with appropriate channels and timers.

### Fetching Dependencies

- The `fetch` method concurrently fetches the `go.mod` files from different repository URLs using goroutines and channels.
- It sets a timeout for the fetching process to prevent indefinite waiting.
- If a timeout occurs, it logs a message and returns.

### Parsing Dependencies

- The `parse` method concurrently parses the fetched `go.mod` files and builds the dependency tree using goroutines and channels.
- It sets a timeout for the parsing process to prevent indefinite waiting.
- If a timeout occurs, it logs a message and returns.

### Error Handling

- The `errorHandler` method handles errors encountered during the fetching and parsing process.
- It logs the errors for further investigation.

## Usage

To use the `dependency_tree` package, follow these steps:

1. Import the package into your Go program.
2. Create a new `DependencyTree` instance using the `NewDependencyTree` function.
3. Implement the HTTP handler to handle the GET requests.
4. Use the `Get` method of the `DependencyTree` instance to process the requests and fetch the dependency trees.

## Conclusion

The `dependency_tree` package provides a convenient way to fetch and parse dependency trees from different repositories, allowing users to analyze and manage dependencies more effectively in their Go projects.

---

This README.md file provides an overview of the `dependency_tree` package, its components, functionalities, and usage instructions. It explains how the solution works, including the concurrent handling of fetching and parsing processes and error handling mechanisms.

Feel free to explore and use this program and API to generate dependency trees for Go projects efficiently.

For any questions or feedback, please reach out to the repository owner.

Project URL: [Repository-Scrapper](https://github.com/tarunngusain08/Repository-Scrapper)

<img width="1512" alt="Screenshot 2024-02-18 at 2 43 02 PM" src="https://github.com/tarunngusain08/Repository-Scrapper/assets/36428256/7024fd27-79e3-4695-a074-9a7c036e4146">

<img width="1512" alt="Screenshot 2024-02-17 at 5 22 55 PM" src="https://github.com/tarunngusain08/Repository-Scrapper/assets/36428256/50971785-443a-44e8-97bd-39fefbd03dce">

<img width="1512" alt="Screenshot 2024-02-17 at 5 23 02 PM" src="https://github.com/tarunngusain08/Repository-Scrapper/assets/36428256/304e180f-b934-4417-9541-58efb739bc7e">
